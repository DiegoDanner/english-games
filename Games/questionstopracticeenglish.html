<!DOCTYPE html>
<html lang="port">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Quiz</title>
    <link rel="stylesheet" href="css/style.css" />
    <style>
        .quiz-container::before {
            content: "";
            background-image: url('img/LOGO_DANNER.png');
            background-size: 130px;
            background-repeat: no-repeat;
            background-position: bottom left;
            opacity: 0.55;
            position: absolute;
            bottom: 20px;
            left: 1px;
            width: 130px;
            height: auto;
            z-index: 0;
            pointer-events: none;
        }
        #quiz-screen {
            position: relative;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <div id="header-placeholder"></div>

   <div id="quiz-container" class="quiz-container" >
        <div id="start-screen">
            <h1 >QUESTIONS TO PRACTICE ENGLISH</h1>
            <p>You'll have 20 seconds for each question. Good luck!</p>
            <button id="start-btn" class="btn">Start Quiz</button>
        </div>
        
        <div id="quiz-screen" class="hidden"> 
            <p id="feedback-message" class="hidden"></p>
            <div id="timer-text"></div>
            <div id="progress-container">
                <p id="question-counter"></p>
                <p id="score-display"></p>
            </div>
            <button id="next-btn" class="hidden btn">Next Question</button>
            <h2 id="question-text"></h2>
            <div id="answer-buttons" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
        </div>

        <div id="result-screen" class="hidden">
            <h1>Quiz Complete!</h1>
            <p id="final-score"></p>
            <p id="score-message"></p>
            <button id="restart-btn" class="btn">Play Again</button>
        </div>
    </div>

    <script src="js/main.js"></script>
    <script type="module" src="js/header.js"></script>
    <script>
        const startScreen = document.getElementById('start-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultScreen = document.getElementById('result-screen');
        const startBtn = document.getElementById('start-btn');
        const restartBtn = document.getElementById('restart-btn');
        const nextBtn = document.getElementById('next-btn');
        const questionText = document.getElementById('question-text');
        const answerButtons = document.getElementById('answer-buttons');
        const feedbackMessage = document.getElementById('feedback-message');
        const questionCounter = document.getElementById('question-counter');
        const scoreDisplay = document.getElementById('score-display');
        const timerText = document.getElementById('timer-text');
        const finalScoreDisplay = document.getElementById('final-score');
        const scoreMessage = document.getElementById('score-message');

        const quizData = {
          "questions": [
            { "question": "Where _____ his sister work? (present)", "answerOptions": [ { "text": "does", "isCorrect": true }, { "text": "do", "isCorrect": false }, { "text": "is", "isCorrect": false }, { "text": "did", "isCorrect": false } ], "hint": "For questions in the present tense about 'he', 'she', or 'it', we use a specific helper verb." },
            { "question": "Would you mind _____ the window?", "answerOptions": [ { "text": "open", "isCorrect": false }, { "text": "opening", "isCorrect": true }, { "text": "to open", "isCorrect": false }, { "text": "opened", "isCorrect": false } ], "hint": "The phrase 'Would you mind...' is followed by a verb in its gerund form (-ing)." },
            { "question": "Choose the word that best fits: 'Iâ€™m really ______ about the trip!'", "answerOptions": [ { "text": "excited", "isCorrect": true }, { "text": "exciting", "isCorrect": false }, { "text": "bored", "isCorrect": false }, { "text": "boring", "isCorrect": false } ], "hint": "The word should describe a person's feeling, not the thing that causes the feeling." },
            { "question": "____ you like to go to the movies tonight?", "answerOptions": [ { "text": "Do", "isCorrect": false }, { "text": "Are", "isCorrect": false }, { "text": "Would", "isCorrect": true }, { "text": "Did", "isCorrect": false } ], "hint": "This word is used to make a polite offer or invitation." },
            { "question": "Helen _____ shopping every week.", "answerOptions": [ { "text": "goes", "isCorrect": true }, { "text": "go", "isCorrect": false }, { "text": "went", "isCorrect": false }, { "text": "is going", "isCorrect": false } ], "hint": "For routine actions in the present tense with 'he', 'she', or 'it', the verb needs a specific ending." },
          ]
        };

        let currentQuestion = 0;
        let score = 0;
        let timer;
        let timeLeft = 20;

        startBtn.addEventListener('click', startQuiz);
        nextBtn.addEventListener('click', () => {
            currentQuestion++;
            showQuestion();
        });
        restartBtn.addEventListener('click', () => {
            resultScreen.classList.add('hidden');
            startScreen.classList.remove('hidden');
            currentQuestion = 0;
            score = 0;
        });

        function startQuiz() {
            startScreen.classList.add('hidden');
            quizScreen.classList.remove('hidden');
            shuffleArray(quizData.questions);
            currentQuestion = 0;
            score = 0;
            showQuestion();
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function showQuestion() {
            resetState();
            if (currentQuestion < quizData.questions.length) {
                const q = quizData.questions[currentQuestion];
                questionText.innerText = q.question;
                questionCounter.innerText = `Question ${currentQuestion + 1} of ${quizData.questions.length}`;
                scoreDisplay.innerText = `Score: ${score}`;

                const shuffledAnswers = [...q.answerOptions];
                shuffleArray(shuffledAnswers);

                shuffledAnswers.forEach(answer => {
                    const btn = document.createElement('button');
                    btn.innerText = answer.text;
                    btn.classList.add('answer-btn', 'btn');
                    btn.dataset.correct = answer.isCorrect;
                    btn.addEventListener('click', selectAnswer);
                    answerButtons.appendChild(btn);
                });
                startTimer();
            } else {
                showResults();
            }
        }

        function selectAnswer(e) {
            clearInterval(timer);
            const selected = e.target;
            const isCorrect = selected.dataset.correct === "true";

            Array.from(answerButtons.children).forEach(btn => {
                btn.disabled = true;
                if (btn.dataset.correct === "true") {
                    btn.classList.add('correct');
                } else {
                    btn.classList.add('incorrect');
                }
            });

            if (isCorrect) {
                feedbackMessage.innerText = "Correct!";
                score++;
            } else {
                feedbackMessage.innerText = "Wrong!";
            }

            feedbackMessage.classList.remove('hidden');
            nextBtn.classList.remove('hidden');
            scoreDisplay.innerText = `Score: ${score}`;
        }

        function resetState() {
            clearInterval(timer);
            timerText.innerText = "";
            nextBtn.classList.add('hidden');
            feedbackMessage.classList.add('hidden');
            answerButtons.innerHTML = "";
        }

        function startTimer() {
            timeLeft = 20;
            timerText.innerText = timeLeft;
            timer = setInterval(() => {
                timeLeft--;
                timerText.innerText = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    showCorrectAnswer();
                }
            }, 1000);
        }

        function showCorrectAnswer() {
            Array.from(answerButtons.children).forEach(btn => {
                btn.disabled = true;
                if (btn.dataset.correct === "true") {
                    btn.classList.add('correct');
                }
            });
            feedbackMessage.innerText = "Time's up!";
            feedbackMessage.classList.remove('hidden');
            nextBtn.classList.remove('hidden');
        }

        function showResults() {
            quizScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');
            finalScoreDisplay.innerText = `You scored ${score} out of ${quizData.questions.length}!`;
            const percent = (score / quizData.questions.length) * 100;
            if (percent === 100) {
                scoreMessage.innerText = "Perfect score! You're a grammar master!";
            } else if (percent >= 75) {
                scoreMessage.innerText = "Great job! You really know your adjectives.";
            } else if (percent >= 50) {
                scoreMessage.innerText = "Not bad! A solid effort.";
            } else {
                scoreMessage.innerText = "Better luck next time! Keep practicing.";
            }
        }
    </script>
</body>
</html>
